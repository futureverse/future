<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plan how to resolve a future — plan • future</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plan how to resolve a future — plan"><meta name="description" content="This function allows the user to plan the future, more specifically,
it specifies how future()s are resolved,
e.g. sequentially or in parallel."><meta property="og:description" content="This function allows the user to plan the future, more specifically,
it specifies how future()s are resolved,
e.g. sequentially or in parallel."><meta property="og:image" content="https://future.futureverse.org/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">future</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.69.0-9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/future-1-overview.html">A Future for R: A Comprehensive Overview</a></li>
    <li><a class="dropdown-item" href="../articles/future-2-output.html">A Future for R: Text and Message Output</a></li>
    <li><a class="dropdown-item" href="../articles/future-2b-backend.html">A Future for R: Available Future Backends</a></li>
    <li><a class="dropdown-item" href="../articles/future-3-topologies.html">A Future for R: Future Topologies</a></li>
    <li><a class="dropdown-item" href="../articles/future-4-issues.html">A Future for R: Common Issues with Solutions</a></li>
    <li><a class="dropdown-item" href="../articles/future-4-non-exportable-objects.html">A Future for R: Non-Exportable Objects</a></li>
    <li><a class="dropdown-item" href="../articles/future-5-startup.html">A Future for R: Controlling Default Future Strategy</a></li>
    <li><a class="dropdown-item" href="../articles/future-6-future-api-backend-specification.html">A Future for R: Future API Backend Specification</a></li>
    <li><a class="dropdown-item" href="../articles/future-7-for-package-developers.html">A Future for R: Best Practices for Package Developers</a></li>
    <li><a class="dropdown-item" href="../articles/future-8-how-future-is-validated.html">A Future for R: How the Future Framework is Validated</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.futureverse.org/"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><a class="external-link dropdown-item" href="https://doFuture.futureverse.org">doFuture (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://furrr.futureverse.org">furrr (map-reduce)</a></li>
    <li><a class="dropdown-item" href="https://future.futureverse.org">future</a></li>
    <li><a class="external-link dropdown-item" href="https://future.apply.futureverse.org">future.apply (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.batchtools.futureverse.org">future.batchtools (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.callr.futureverse.org">future.callr (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mirai.futureverse.org">future.mirai (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tests.futureverse.org">future.tests</a></li>
    <li><a class="external-link dropdown-item" href="https://futurize.futureverse.org">futurize (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://globals.futureverse.org">globals</a></li>
    <li><a class="external-link dropdown-item" href="https://listenv.futureverse.org">listenv</a></li>
    <li><a class="external-link dropdown-item" href="https://parallelly.futureverse.org">parallelly</a></li>
    <li><a class="external-link dropdown-item" href="https://progressr.futureverse.org">progressr</a></li>
    <li><a class="external-link dropdown-item" href="https://BiocParallel.FutureParam.futureverse.org">BiocParallel.FutureParam (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tools.futureverse.org">future.tools (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mapreduce.futureverse.org">future.mapreduce (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://marshal.futureverse.org">marshal (experimental)</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cloud.r-project.org/package=future"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/futureverse/future/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plan how to resolve a future</h1>
      <small class="dont-index">Source: <a href="https://github.com/futureverse/future/blob/HEAD/R/utils_api-plan.R" class="external-link"><code>R/utils_api-plan.R</code></a>, <a href="https://github.com/futureverse/future/blob/HEAD/R/utils_api-plan-with.R" class="external-link"><code>R/utils_api-plan-with.R</code></a>, <a href="https://github.com/futureverse/future/blob/HEAD/R/utils_api-tweak.R" class="external-link"><code>R/utils_api-tweak.R</code></a></small>
      <div class="d-none name"><code>plan.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows <em>the user</em> to plan the future, more specifically,
it specifies how <code><a href="future.html">future()</a></code>s are resolved,
e.g. sequentially or in parallel.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plan</span><span class="op">(</span></span>
<span>  strategy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  substitute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .call <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .cleanup <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  .init <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'FutureStrategyList'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">expr</span>, <span class="va">...</span>, local <span class="op">=</span> <span class="cn">FALSE</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>, .cleanup <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tweak</span><span class="op">(</span><span class="va">strategy</span>, <span class="va">...</span>, penvir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-strategy">strategy<a class="anchor" aria-label="anchor" href="#arg-strategy"></a></dt>
<dd><p>A future backend or the name of one.</p></dd>


<dt id="arg-substitute">substitute<a class="anchor" aria-label="anchor" href="#arg-substitute"></a></dt>
<dd><p>If <code>TRUE</code>, the <code>strategy</code> expression is
<code><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute()</a></code>:d, otherwise not.</p></dd>


<dt id="arg--skip">.skip<a class="anchor" aria-label="anchor" href="#arg--skip"></a></dt>
<dd><p>(internal) If <code>TRUE</code>, then attempts to set a future backend
that is the same as what is currently in use, will be skipped.</p></dd>


<dt id="arg--call">.call<a class="anchor" aria-label="anchor" href="#arg--call"></a></dt>
<dd><p>(internal) Used for recording the call to this function.</p></dd>


<dt id="arg--cleanup">.cleanup<a class="anchor" aria-label="anchor" href="#arg--cleanup"></a></dt>
<dd><p>(internal) Used to stop implicitly started clusters.</p></dd>


<dt id="arg--init">.init<a class="anchor" aria-label="anchor" href="#arg--init"></a></dt>
<dd><p>(internal) Used to initiate workers.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The future plan to use temporarily, e.g. <code>plan(multisession)</code>.</p></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>The R expression to be evaluated.</p></dd>


<dt id="arg-local">local<a class="anchor" aria-label="anchor" href="#arg-local"></a></dt>
<dd><p>If TRUE, then the future plan specified by <code>data</code>
is applied temporarily in the calling frame. Argument <code>expr</code> must
not be specified if <code>local = TRUE</code>.</p></dd>


<dt id="arg-envir">envir<a class="anchor" aria-label="anchor" href="#arg-envir"></a></dt>
<dd><p>The environment where the future plan should be set and the
expression evaluated.</p></dd>


<dt id="arg-penvir">penvir<a class="anchor" aria-label="anchor" href="#arg-penvir"></a></dt>
<dd><p>The environment used when searching for a future
function by its name.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments overriding the default arguments
of the evaluation function.  Which additional arguments are supported
depends on which future backend is used, e.g. several support
argument <code>workers</code> but not all. For details, see the individual
backends of which some are linked to below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>plan()</code> returns the previous plan invisibly if a new future backend
is chosen, otherwise it returns the current one visibly.</p>
<p>The value of the expression evaluated (invisibly).</p>
<p>a future function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default backend is <code><a href="sequential.html">sequential</a></code>, but another one can be set
using <code>plan()</code>, e.g. <code>plan(multisession)</code> will launch parallel workers
running in the background, which then will be used to resolve futures.
To shut down background workers launched this way, call <code>plan(sequential)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="built-in-evaluation-strategies">Built-in evaluation strategies<a class="anchor" aria-label="anchor" href="#built-in-evaluation-strategies"></a></h2>


<p>The <span class="pkg">future</span> package provides the following built-in backends:</p>
<dl><dt><code><a href="sequential.html">sequential</a></code>:</dt>
<dd><p>Resolves futures sequentially in the current <span style="R">R</span> process, e.g.
<code>plan(sequential)</code>.</p></dd>

<dt><code><a href="multisession.html">multisession</a></code>:</dt>
<dd><p>Resolves futures asynchronously (in parallel) in separate
<span style="R">R</span> sessions running in the background on the same machine, e.g.
<code>plan(multisession)</code> and <code>plan(multisession, workers = 2)</code>.</p></dd>

<dt><code><a href="multicore.html">multicore</a></code>:</dt>
<dd><p>Resolves futures asynchronously (in parallel) in separate
<em>forked</em> <span style="R">R</span> processes running in the background on
the same machine, e.g.
<code>plan(multicore)</code> and <code>plan(multicore, workers = 2)</code>.
This backend is not supported on Windows.</p></dd>

<dt><code><a href="cluster.html">cluster</a></code>:</dt>
<dd><p>Resolves futures asynchronously (in parallel) in separate
<span style="R">R</span> sessions running typically on one or more machines, e.g.
<code>plan(cluster)</code>, <code>plan(cluster, workers = 2)</code>, and
<code>plan(cluster, workers = c("n1", "n1", "n2", "server.remote.org"))</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="other-evaluation-strategies-available">Other evaluation strategies available<a class="anchor" aria-label="anchor" href="#other-evaluation-strategies-available"></a></h2>



<p>In addition to the built-in ones, additional parallel backends are
implemented in future-backend packages <span class="pkg">future.callr</span> and
<span class="pkg">future.mirai</span> that leverage R package <span class="pkg">callr</span> and
<span class="pkg">mirai</span>:</p>
<dl><dt><code>callr</code>:</dt>
<dd><p>Similar to <code>multisession</code>, this resolves futures in parallel in
background <span style="R">R</span> sessions on the local machine via the <span class="pkg">callr</span>
package, e.g. <code>plan(future.callr::callr)</code> and
<code>plan(future.callr::callr, workers = 2)</code>. The difference is that
each future is processed in a fresh parallel R worker, which is
automatically shut down as soon as the future is resolved.
This can help decrease the overall memory usage. Moreover, contrary
to <code>multisession</code>, <code>callr</code> does not rely on socket connections,
which means it is not limited by the number of connections that
<span style="R">R</span> can have open at any time.</p></dd>


<dt><code>mirai_multisession</code>:</dt>
<dd><p>Similar to <code>multisession</code>, this resolves futures in parallel in
background <span style="R">R</span> sessions on the local machine via the <span class="pkg">mirai</span>
package, e.g. <code>plan(future.mirai::mirai_multisession)</code> and
<code>plan(future.mirai::mirai_multisession, workers = 2)</code>.</p></dd>


<dt><code>mirai_cluster</code>:</dt>
<dd><p>Similar to <code>cluster</code>, this resolves futures in parallel via
pre-configured <span style="R">R</span> <span class="pkg">mirai</span> daemon processes, e.g.
<code>plan(future.mirai::mirai_cluster)</code>.</p></dd>


</dl><p>Another example is the <span class="pkg">future.batchtools</span> package, which leverages
<span class="pkg">batchtools</span> package, to resolve futures via high-performance compute
(HPC) job schedulers, e.g. LSF, Slurm, TORQUE/PBS, Grid Engine, and
OpenLava;</p>
<dl><dt><code>batchtools_slurm</code>:</dt>
<dd><p>The backend resolves futures via the Slurm scheduler, e.g.
<code>plan(future.batchtools::batchtools_slurm)</code>.</p></dd>


<dt><code>batchtools_torque</code>:</dt>
<dd><p>The backend resolves futures via the TORQUE/PBS scheduler, e.g.
<code>plan(future.batchtools::batchtools_torque)</code>.</p></dd>


<dt><code>batchtools_sge</code>:</dt>
<dd><p>The backend resolves futures via the Grid Engine (SGE, AGE) scheduler,
e.g. <code>plan(future.batchtools::batchtools_sge)</code>.</p></dd>


<dt><code>batchtools_lsf</code>:</dt>
<dd><p>The backend resolves futures via the Load Sharing Facility (LSF)
scheduler, e.g. <code>plan(future.batchtools::batchtools_lsf)</code>.</p></dd>


<dt><code>batchtools_openlava</code>:</dt>
<dd><p>The backend resolves futures via the OpenLava scheduler, e.g.
<code>plan(future.batchtools::batchtools_openlava)</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="for-package-developers">For package developers<a class="anchor" aria-label="anchor" href="#for-package-developers"></a></h2>



<p>Please refrain from modifying the future backend inside your packages /
functions, i.e. do not call <code>plan()</code> in your code. Instead, leave
the control on what backend to use to the end user. This idea is part of
the core philosophy of the future framework—as a developer you can never
know what future backends the user have access to. Moreover, by not making
any assumptions about what backends are available, your code will also work
automatically with any new backends developed after you wrote your code.</p>
<p>If you think it is necessary to modify the future backend within a
function, then make sure to undo the changes when exiting the function.
This can be achieved by using <code>with(plan(...), local = TRUE)</code>, e.g.</p>
<div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="../reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span>, local <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">analyze</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>

<p>This is important because the end-user might have already set the future
strategy elsewhere for other purposes and will most likely not know that
calling your function will break their setup.
<em>Remember, your package and its functions might be used in a greater
context where multiple packages and functions are involved and those might
also rely on the future framework, so it is important to avoid stepping on
others' toes.</em></p>
    </div>
    <div class="section level2">
    <h2 id="using-plan-in-scripts-and-vignettes">Using plan() in scripts and vignettes<a class="anchor" aria-label="anchor" href="#using-plan-in-scripts-and-vignettes"></a></h2>



<p>When writing scripts or vignettes that use futures, try to place any
call to <code>plan()</code> as far up (i.e. as early on) in the code as possible.
This will help users to quickly identify where the future plan is set up
and allow them to modify it to their computational resources.
Even better is to leave it to the user to set the <code>plan()</code> prior to
<code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code>:ing the script or running the vignette.
If a <code class="file"><a href="zzz-future.options.html">.future.R</a></code> exists in the current directory and / or in
the user's home directory, it is sourced when the <span class="pkg">future</span> package is
<em>loaded</em>. Because of this, the <code class="file">.future.R</code> file provides a
convenient place for users to set the <code>plan()</code>.
This behavior can be controlled via an <span style="R">R</span> option—see
<a href="zzz-future.options.html">future options</a> for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Use <code>plan()</code> to set a future to become the
new default strategy.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An sequential future</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, c <span class="op">=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="co">## All NAs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ a: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c: num NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A sequential future with lazy evaluation</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span></span></span>
<span class="r-in"><span><span class="op">}</span>, lazy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, c <span class="op">=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="co">## All NAs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ a: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c: num NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A multicore future (specified as a string)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="st">"multicore"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, c <span class="op">=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="co">## All NAs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ a: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c: num NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multisession futures gives an error on R CMD check on</span></span></span>
<span class="r-in"><span><span class="co">## Windows (but not Linux or macOS) for unknown reasons.</span></span></span>
<span class="r-in"><span><span class="co">## The same code works in package tests.</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A multisession future (specified via a string variable)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="st">"future::multisession"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, c <span class="op">=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="co">## All NAs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ a: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b: num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c: num NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Explicitly specifying number of workers</span></span></span>
<span class="r-in"><span><span class="co">## (default is parallelly::availableCores())</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">multicore</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Number of parallel workers: "</span>, <span class="fu"><a href="nbrOfWorkers.html">nbrOfWorkers</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of parallel workers: 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Explicitly close multisession workers by switching plan</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Evaluate a future using the 'multisession' plan</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w_pid</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span>, worker <span class="op">=</span> <span class="va">w_pid</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    main  worker </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3543216 3546139 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Evaluate a future locally using the 'multisession' plan</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, local <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="future.html">future</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">w_pid</span> <span class="op">&lt;-</span> <span class="fu"><a href="value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html" class="external-link">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span>, worker <span class="op">=</span> <span class="va">w_pid</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    main  worker </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3543216 3546237 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

